[[georepl-deploy]]
== Run {productname} with storage preferences

.  Copy the config.yaml to all machines running {productname}

.  For each machine in each region, add a
`QUAY_DISTRIBUTED_STORAGE_PREFERENCE` environment variable with the
preferred storage engine for the region in which the machine is running.
+
For example, for a machine running in Europe with the config
directory on the host available from /mnt/quay/config:
ifdef::upstream[]
+
[source,yaml,subs="verbatim,attributes"]
----
# sudo podman login quay.io
Username: yourquayuser
Password: *****
# sudo podman run -d -p 443:8443 -p 8080:8080 -v /mnt/quay/config:/conf/stack:Z \
    -e QUAY_DISTRIBUTED_STORAGE_PREFERENCE=europestorage \
    <registry>/<repo>/quay:{productmin}
----
endif::upstream[]
ifdef::downstream[]
+
[source,yaml,subs="verbatim,attributes"]
----
# sudo podman login quay.io
Username: yourquayuser
Password: *****
# sudo podman run -d -p 443:8443 -p 8080:8080 -v /mnt/quay/config:/conf/stack:Z \
    -e QUAY_DISTRIBUTED_STORAGE_PREFERENCE=europestorage \
    {productrepo}/{quayimage}:{productminv}
----
endif::downstream[]
+
[NOTE]
====
The value of the environment variable specified must match the
name of a Location ID as defined in the config panel.
====

.  Restart all {productname} containers